1.首先，确保你已经安装了pyinstaller。可以使用以下命令通过pip进行安装

打开pycharm终端窗口，输入命令，安装pyinstaller

```python
pip install pyinstaller
```

2.在命令行中，导航到包含你的Python脚本的目录（就是在终端中cd到要打包文件的目录中）

3.使用以下命令运行pyinstaller，将你的脚本转换为可执行的EXE文件（如果是mac或linux系统则打包为该系统下的可执行文件）**your_script**为要打包的文件名

```
pyinstaller --onefile your_script.py
```

这将在当前目录中创建一个名为`dist`的文件夹，其中包含生成的EXE(可执行)文件。

4.为了添加图标，你需要准备一个ICO文件。将ICO文件保存在与你的脚本文件相同的目录下，并将其命名为`icon.ico`。

可以利用python代码进行图片转换，记得替换要转换图片的名称

先在终端里安装pystray库，命令如下

```
pip install pystray
```

然后执行下面代码，注意更改图片名称

```python
from PIL import Image
import pystray
from pystray import MenuItem as item

def convert_png_to_ico(png_path, ico_path):
    image = Image.open(png_path)
    image.save(ico_path, format='ICO')

# 示例用法
png_file = 'image.png'
ico_file = 'icon.ico'
convert_png_to_ico(png_file, ico_file)

```

5.修改生成的EXE文件的属性，以指定使用图标。使用以下命令：

```python
pyinstaller --onefile --icon=icon.ico your_script.py
```

这将在生成的EXE文件中包含指定的图标。

请注意，图标文件必须是ICO格式的，并且要与你的脚本文件位于同一目录下。